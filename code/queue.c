#include "queue.h"


/**************************************************************************************************************************
Create queue with dimension dim.
**************************************************************************************************************************/
void create(queue * q, unsigned int dim)
{
	q->array = malloc(dim * sizeof(char *));
	q->first = 0;
	q->last = 0;
}


/**************************************************************************************************************************
Empty the queue
**************************************************************************************************************************/
void reset(queue * q)
{
	free(q->array);
	q->first = 0;
	q->last = 0;
}


/**************************************************************************************************************************
Return 1 if it's empty, else 0
**************************************************************************************************************************/
unsigned int isEmpty(queue * q)
{
	if (q->first == q->last)
		return 1;
	return 0;
}


/**************************************************************************************************************************
Add element in queue
**************************************************************************************************************************/
void enqueue(queue * q, char *str)
{
	q->array[q->last] = str;
	q->last++;
}


/**************************************************************************************************************************
Take first element of queue 
**************************************************************************************************************************/
char *dequeue(queue * q)
{
	q->first++;
	return q->array[q->first - 1];
}


/**************************************************************************************************************************
Return 1 if in the queue there are two | consecutive, else return 0
**************************************************************************************************************************/
unsigned int checkPipeError(const queue * q)
{
	for (int i = q->first; i < q->last - 1; i++) {
		if (q->array[i][0] == '|' && q->array[i + 1][0] == '|')
			return 1;
		if (q->array[i][0] == '|' && (q->array[i + 1][0] == '<' || q->array[i + 1][0] == '>'))
			return 1;
	}
	if(q->array[q->last-1][0] == '|')
		return 1;
	return 0;
}


/**************************************************************************************************************************
Return number of elements in the queue
**************************************************************************************************************************/
unsigned int size(const queue * q)
{
	return (q->last - q->first);
}


/**************************************************************************************************************************
Copy q into q2
**************************************************************************************************************************/
void copyQueue(const queue * q, queue * q2)
{
	unsigned int length;
	length = size(q);
	for (unsigned int i = 0; i < length; i++)
		enqueue(q2, q->array[i]);
}


/**************************************************************************************************************************
Print the queue
**************************************************************************************************************************/
void printQueue(const queue * q)
{
	unsigned int i;
	for (i = q->first; i < q->last; i++)
		fprintf(stdout, "%s\n", q->array[i]);
}
